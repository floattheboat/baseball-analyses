---
title: "Baseball Exploratory"
author: "Matthew Johns"
date: "4/21/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

```{r necessities}

source("libraries.R")
source("queries.R")

```

```{r data-ingest}

con <- dbConnect(RSQLite::SQLite(), "background-files/lahmansbaseballdb.sqlite")

teams <- dbGetQuery(con, q_teams)

salaries <- dbGetQuery(con, q_salaries)

postseason <- dbGetQuery(con, q_postseason)

head(postseason)


dbDisconnect(con)

```



```{r salaries-prep}

# count(salaries, salary, sort = FALSE)   # Values below $60,000 are outliers

salaries <- salaries %>% filter(salary >= 60000)

```


```{r team-payroll}

payroll <- salaries %>% group_by(teamID, yearID) %>% summarise(payroll = sum(salary)/1000000)   # in millions

payroll <- payroll %>% left_join(teams, by = c("yearID","teamID"))

payroll <- payroll %>% mutate(WSWin = factor(WSWin)
                              ,yearID = factor(yearID))

ggplot(payroll, aes(yearID, payroll)) + geom_boxplot() + theme(axis.text.x = element_text(vjust = 0.5, hjust = 1, angle = 90))



```



